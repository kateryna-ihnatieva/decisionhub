# Руководство по загрузке файлов для анализа иерархий

## Поддерживаемые форматы файлов

- **Excel**: `.xlsx`, `.xls`
- **CSV**: `.csv` (с разделителями: запятая, точка с запятой, табуляция, вертикальная черта)

## Структура файла для анализа иерархий

### Основные требования

Для анализа иерархий файл должен содержать **несколько матриц**, разделенных пустыми строками:

1. **Первая матрица (критерии)**: Содержит имена критериев и матрицу их попарного сравнения
2. **Вторая матрица (альтернативы)**: Содержит имена альтернатив и матрицу их попарного сравнения
3. **Последующие матрицы**: Матрицы попарных сравнений альтернатив по каждому критерию
4. **Разделитель**: Матрицы разделяются пустой строкой
5. **Имена в первой строке и первом столбце**: Каждая матрица должна содержать имена как в первой строке (исключая первую ячейку), так и в первом столбце (исключая первую ячейку)
6. **Первая ячейка (A1)**: Обычно пустая или содержит метку
7. **Числовые данные**: Матрицы должны содержать числовые значения для сравнения

### Пример структуры CSV файла для анализа иерархий

```csv
,a1,a2,a3
a1,1,2,3
a2,1/2,1,4
a3,1/3,1/4,1

,й1,й2,й3,й4
й1,1,5,1,1
й2,1/5,1,1,1
й3,1,1,1,1
й4,1,1,1,1

,й1,й2,й3,й4
й1,1,6,7,8
й2,1/6,1,9,1
й3,1/7,1/9,1,8
й4,1/8,1,1/8,1
```

**Объяснение:**
- Строки 1-4: Матрица критериев (a1, a2, a3)
- Строка 5: Пустая строка-разделитель
- Строки 6-10: Матрица альтернатив (й1, й2, й3, й4)
- Строка 11: Пустая строка-разделитель
- Строки 12-16: Матрица сравнения альтернатив по первому критерию
- Строка 17: Пустая строка-разделитель
- Строки 18-22: Матрица сравнения альтернатив по второму критерию

### Пример структуры Excel файла

|     | A        | B        | C        | D        |
|-----|----------|----------|----------|----------|
| 1   |          | л1       | л2       |          |
| 2   | л1       | 1        | 2        |          |
| 3   | л2       | 1/2      | 1        |          |

## Поддерживаемые форматы чисел

### Обычные числа
- `1`, `2`, `3`, `5`
- `0.33`, `0.5`, `0.2`

### Дроби
- `1/2` → 0.5
- `1/3` → 0.333...
- `1/5` → 0.2
- `2/3` → 0.666...

### Научная нотация
- `1e-2` → 0.01
- `5E+1` → 50.0

## Как использовать

1. **Перейдите на страницу ввода имен** для любого метода анализа
2. **Найдите секцию "Завантажити з файлу"**
3. **Выберите файл** одним из способов:
   - Перетащите файл в область загрузки
   - Нажмите "Вибрати файл" и выберите файл
4. **Дождитесь обработки** - система автоматически:
   - Проверит формат файла
   - Извлечет имена критериев/альтернатив
   - Заполнит поля формы
5. **Продолжите работу** с заполненными данными

## Ограничения

- **Размер файла**: максимум 10 МБ
- **Кодировка**: UTF-8 для CSV файлов
- **Размер матрицы**: должен соответствовать указанному количеству критериев/альтернатив

## Обработка ошибок

### Частые ошибки и их решения

1. **"Unsupported file format"**
   - Убедитесь, что файл имеет расширение .xlsx, .xls или .csv

2. **"File too large"**
   - Уменьшите размер файла до 10 МБ или меньше

3. **"Insufficient data"**
   - Проверьте, что в файле достаточно строк и столбцов для указанного размера матрицы

4. **"Could not extract valid names"**
   - Убедитесь, что имена находятся в первой строке и/или первом столбце
   - Проверьте, что имена не пустые

5. **"Duplicate names found"**
   - Убедитесь, что все имена уникальны

6. **"No numeric data found in matrix"**
   - Проверьте, что матрица содержит числовые значения
   - Убедитесь, что дроби записаны правильно (например, 1/2, а не 1 2)

## Примеры файлов

### Простая матрица 2x2
```csv
,л1,л2
л1,1,2
л2,1/2,1
```

### Матрица 3x3 с дробями
```csv
,Критерий1,Критерий2,Критерий3
Критерий1,1,3,5
Критерий2,1/3,1,2
Критерий3,1/5,1/2,1
```

### Матрица с равными значениями
```csv
,й1,й2
й1,1,1
й2,1,1
```

### Для анализа иерархий (несколько матриц)

#### Файл с критериями и альтернативами
```csv
,Критерий1,Критерий2
Критерий1,1,3
Критерий2,1/3,1

,Альтернатива1,Альтернатива2
Альтернатива1,1,2
Альтернатива2,1/2,1

,Альтернатива1,Альтернатива2
Альтернатива1,1,5
Альтернатива2,1/5,1
```

#### Файл с кириллическими именами
```csv
,а1,а2
а1,1,2
а2,1/2,1

,й1,й2
й1,1,5
й2,1/5,1

,й1,й2
й1,1,3
й2,1/3,1
```

## Технические детали

- **Автоматическое определение разделителей** для CSV файлов
- **Поддержка различных форматов чисел** включая дроби
- **Валидация данных** на клиенте и сервере
- **Автоматическая очистка** временных файлов после обработки
- **Безопасная обработка** с проверкой типов файлов
