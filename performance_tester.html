<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decision Methods Performance Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .method-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            background: #fafafa;
        }
        .method-card h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        .test-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .test-file {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        .parameters {
            background: #f0f8e8;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #27ae60;
        }
        .timer {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            text-align: center;
            margin: 20px 0;
        }
        .timer-display {
            font-size: 2em;
            font-weight: bold;
            color: #e74c3c;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .results-table th,
        .results-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .results-table th {
            background-color: #34495e;
            color: white;
        }
        .results-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .btn {
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #2980b9;
        }
        .btn-success {
            background: #27ae60;
        }
        .btn-success:hover {
            background: #229954;
        }
        .btn-danger {
            background: #e74c3c;
        }
        .btn-danger:hover {
            background: #c0392b;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.pending {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        .status.completed {
            background: #d4edda;
            border-left: 4px solid #28a745;
        }
        .status.error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Decision Methods Performance Tester</h1>

        <div class="test-info">
            <div class="test-file">
                <h4>üìÅ Test Files Location</h4>
                <p><strong>Directory:</strong> test_files/</p>
                <p><strong>Scenario:</strong> Choosing the best smartphone</p>
                <p><strong>Alternatives:</strong> iPhone 15, Samsung Galaxy S24, Google Pixel 8, OnePlus 12</p>
            </div>
            <div class="parameters">
                <h4>‚öôÔ∏è Testing Parameters</h4>
                <p><strong>Iterations:</strong> 3-5 per method</p>
                <p><strong>Metrics:</strong> Execution time, results, consistency</p>
                <p><strong>Goal:</strong> Compare method performance</p>
            </div>
        </div>

        <div class="timer">
            <h4>‚è±Ô∏è Execution Timer</h4>
            <div class="timer-display" id="timer">00:00.000</div>
            <button class="btn btn-success" onclick="startTimer()">Start Timer</button>
            <button class="btn btn-danger" onclick="stopTimer()">Stop Timer</button>
            <button class="btn" onclick="resetTimer()">Reset</button>
        </div>

        <div id="methods-container">
            <!-- Methods will be populated by JavaScript -->
        </div>

        <h2>üìä Results Summary</h2>
        <table class="results-table" id="results-table">
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Avg Time (s)</th>
                    <th>Min Time (s)</th>
                    <th>Max Time (s)</th>
                    <th>Optimal Choice</th>
                    <th>Ranking</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="results-body">
            </tbody>
        </table>

        <div style="text-align: center; margin: 30px 0;">
            <button class="btn" onclick="exportResults()">üì• Export Results</button>
            <button class="btn" onclick="clearResults()">üóëÔ∏è Clear All</button>
        </div>
    </div>

    <script>
        const methods = [
            {
                name: "AHP (Analytic Hierarchy Process)",
                file: "Hierarchy_Test_Data.xlsx",
                parameters: "5 criteria, 4 alternatives",
                route: "/hierarchy",
                status: "pending"
            },
            {
                name: "Binary Relations",
                file: "Binary_Relations_Test_Data.xlsx",
                parameters: "4 alternatives",
                route: "/binary",
                status: "pending"
            },
            {
                name: "Expert Evaluation",
                file: "Expert_Evaluation_Test_Data.xlsx",
                parameters: "4 experts, 4 alternatives",
                route: "/experts",
                status: "pending"
            },
            {
                name: "Laplace Criterion",
                file: "Laplace_Test_Data.xlsx",
                parameters: "4 alternatives, 4 conditions",
                route: "/laplasa",
                status: "pending"
            },
            {
                name: "Maximin Criterion",
                file: "Maximin_Test_Data.xlsx",
                parameters: "4 alternatives, 4 conditions",
                route: "/maximin",
                status: "pending"
            },
            {
                name: "Savage Criterion",
                file: "Savage_Test_Data.xlsx",
                parameters: "4 alternatives, 4 conditions",
                route: "/savage",
                status: "pending"
            },
            {
                name: "Hurwitz Criterion",
                file: "Hurwitz_Test_Data.xlsx",
                parameters: "4 alternatives, 4 conditions, Œ±=0.5",
                route: "/hurwitz",
                status: "pending"
            }
        ];

        let timerInterval;
        let startTime;
        let isRunning = false;
        let currentMethod = null;
        let results = {};

        function initializeMethods() {
            const container = document.getElementById('methods-container');
            container.innerHTML = '';

            methods.forEach((method, index) => {
                const methodCard = document.createElement('div');
                methodCard.className = 'method-card';
                methodCard.innerHTML = `
                    <h3>${method.name}</h3>
                    <div class="test-file">
                        <strong>Test File:</strong> ${method.file}<br>
                        <strong>Parameters:</strong> ${method.parameters}<br>
                        <strong>Route:</strong> ${method.route}
                    </div>
                    <div class="status ${method.status}" id="status-${index}">
                        Status: ${method.status.charAt(0).toUpperCase() + method.status.slice(1)}
                    </div>
                    <div style="margin-top: 15px;">
                        <button class="btn" onclick="testMethod(${index})">üß™ Test Method</button>
                        <button class="btn btn-success" onclick="markCompleted(${index})">‚úÖ Mark Completed</button>
                        <button class="btn btn-danger" onclick="markError(${index})">‚ùå Mark Error</button>
                    </div>
                `;
                container.appendChild(methodCard);
            });
        }

        function startTimer() {
            if (isRunning) return;
            startTime = Date.now();
            isRunning = true;
            timerInterval = setInterval(updateTimer, 10);
        }

        function stopTimer() {
            if (!isRunning) return;
            isRunning = false;
            clearInterval(timerInterval);
            return getElapsedTime();
        }

        function resetTimer() {
            isRunning = false;
            clearInterval(timerInterval);
            document.getElementById('timer').textContent = '00:00.000';
        }

        function updateTimer() {
            const elapsed = getElapsedTime();
            document.getElementById('timer').textContent = formatTime(elapsed);
        }

        function getElapsedTime() {
            return (Date.now() - startTime) / 1000;
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = (seconds % 60).toFixed(3);
            return `${mins.toString().padStart(2, '0')}:${secs.padStart(6, '0')}`;
        }

        function testMethod(index) {
            const method = methods[index];
            currentMethod = index;

            // Open the method page in a new tab
            const url = `http://localhost:5050${method.route}`;
            window.open(url, '_blank');

            // Start timer
            startTimer();

            // Update status
            updateMethodStatus(index, 'testing');
        }

        function markCompleted(index) {
            const elapsed = stopTimer();
            const method = methods[index];

            // Prompt for results
            const optimal = prompt(`Enter optimal choice for ${method.name}:`);
            const ranking = prompt(`Enter ranking (1st, 2nd, 3rd, 4th):`);

            if (optimal && ranking) {
                results[index] = {
                    method: method.name,
                    time: elapsed,
                    optimal: optimal,
                    ranking: ranking,
                    status: 'completed'
                };

                updateMethodStatus(index, 'completed');
                updateResultsTable();
            }
        }

        function markError(index) {
            stopTimer();
            updateMethodStatus(index, 'error');
            results[index] = {
                method: methods[index].name,
                time: 0,
                optimal: 'Error',
                ranking: 'Error',
                status: 'error'
            };
            updateResultsTable();
        }

        function updateMethodStatus(index, status) {
            methods[index].status = status;
            const statusElement = document.getElementById(`status-${index}`);
            statusElement.className = `status ${status}`;
            statusElement.textContent = `Status: ${status.charAt(0).toUpperCase() + status.slice(1)}`;
        }

        function updateResultsTable() {
            const tbody = document.getElementById('results-body');
            tbody.innerHTML = '';

            Object.values(results).forEach(result => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${result.method}</td>
                    <td>${result.time.toFixed(3)}</td>
                    <td>${result.time.toFixed(3)}</td>
                    <td>${result.time.toFixed(3)}</td>
                    <td>${result.optimal}</td>
                    <td>${result.ranking}</td>
                    <td>${result.status}</td>
                `;
            });
        }

        function exportResults() {
            const data = {
                timestamp: new Date().toISOString(),
                results: results,
                methods: methods
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `performance_test_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function clearResults() {
            if (confirm('Are you sure you want to clear all results?')) {
                results = {};
                methods.forEach((_, index) => {
                    updateMethodStatus(index, 'pending');
                });
                updateResultsTable();
                resetTimer();
            }
        }

        // Initialize the page
        initializeMethods();
    </script>
</body>
</html>
